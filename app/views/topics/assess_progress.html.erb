<% provide(:title, "Assess #{@outcome_area.name} for #{@language.name}") %>

<datalist id="pm-data" class="hide">
  <% ProgressMarker.spread_text.each do |key, text| %>
    <option label="<%= text %>" id="spread-<%= key %>"><%= key %></option>
  <% end %>
</datalist>

<div class="row">
  <div class="col s12 m6">
  	<%= render partial: 'topic', object: @outcome_area %>
  </div>
  <div class="col s12 m6">
  	<%= render partial: 'languages/language_card', object: @language %>
  </div>
</div>

<% @progress_markers_by_weight.each do |weight, progress_marker_group| %>
  <div class="row">
    <h2><%= ProgressMarker.weight_text[weight] %></h2>
    <ul class="collapsible" data-collapsible="accordion">
      <% progress_marker_group.each do |progress_marker| %>
        <li>
          <div class="collapsible-header"><%= progress_marker.name %></div>
          <div class="collapsible-body">

            <div class="row">
              <div class="col s6">
                <p><%= progress_marker.description %></p>
              </div>
              <div class="col s6 range-field activity-level-select">
                <%= label_tag("#{progress_marker.id}_#{@language.id}", "Asses the level of activity this month for #{@language.name}") %>
              	<%= range_field(progress_marker.id, @language.id, in: ProgressMarker.spread_text.keys, list: "pm-data") %>
                <div class="spreadness-text"></div>
              </div>
            </div>
            
            <% if @reports_by_progress_marker[progress_marker.id] %>
              <% @reports_by_progress_marker[progress_marker.id].in_groups_of(3, false) do |report_group| %>
				  <div class="row">
				    <% report_group.each do |report| %>
				      <div class="col s12 m6 l4">
				        <%= render partial: "impact_reports/report", object: report, locals: {time: true, languages: false, topics: false, wrapper: false} %>
				      </div>
				    <% end %>
				  </div>
              <% end %>
            <% else %>
              <p>There are no impact reports for <%= @language.name %> with this progress marker.</p>
            <% end %>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
<% end %>