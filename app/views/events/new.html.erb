<% provide(:title, 'Report on an event') %>
<h1><i class="material-icons large">event</i> Report on an Event</h1>
<div class="row">
  <%= form_for(@event, html: {class: "col s12"}) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="row">
      <div class="col s8">

        <div class="row">
          <div class="input-field col s12">
            <i class="material-icons prefix">label</i>
            <%= f.text_field :event_label %>
            <%= f.label :event_label, "Event Name" %>
          </div>
        </div>

        <div class="row">
          <div class="col s8">
            <i class="material-icons prefix">location_on</i>
            <%= label_tag "Location" %>
            <div class="input-field">
              <%= f.text_field :district %>
              <%= f.label :district %>
            </div>
            <div class="input-field">
              <%= f.text_field :sub_district %>
              <%= f.label :sub_district, "Sub-district" %>
            </div>
            <div class="input-field">
              <%= f.text_field :village %>
              <%= f.label :village %>
            </div>
          </div>
          <div class="col s4">
            <div class="input-field">
              <i class="material-icons prefix">today</i>
              <%= f.date_field :event_date, class: "datepicker active" %>
              <%= f.label :event_date, "Date" %>
            </div>
            <div class="input-field">
              <%= f.number_field :participant_amount %>
              <%= f.label :participant_amount, "Total number of participants" %>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="input-field col s12">
            <%= render partial: "shared/multiselect", locals: {
            	text: "Languages involved...",
            	icon: "language",
            	object: "event",
            	attribute: "languages",
              display: :name,
            	collection: @minority_languages,
            	selected: Hash.new
            } %>
          </div>
        </div>

        <div class="row">
          <div class="input-field col s12">
            <!--i class="material-icons prefix">directions_walk</i-->
            <%= render partial: "shared/multiselect", locals: {
              text: "Purpose: To enable...",
              icon: "directions_walk",
              object: "event",
              attribute: "purposes",
              display: :description,
              collection: @all_purposes,
              selected: Hash.new
            } %>
          </div>
        </div>

      </div>
      <div class="input-field people-increase col s4">
        <i class="material-icons prefix">people</i>
        <%= autocomplete_field_tag "person__0", '', autocomplete_person_name_events_path %>
        <%= label_tag :person__0, "Key people involved", {class: "tooltipped", "data-position" => "top", "data-delay" => "50", "data-tooltip" => "Write one name in each row"} %>
      </div>
    </div>
    <% Event.yes_no_questions.each do |code, question| %>
      <div class="yes-no-question">

        <div class="row">
          <div class="col s10">
            <i class="material-icons">question_answer</i>
            <span class="event-question"><%= question %></span>
          </div>
          <div class="col s2 input-field">
          	<%= radio_button_tag(code, "no") %>
          	<%= label_tag("#{code}_no", "No") %>
          	<%= radio_button_tag(code, "yes") %>
          	<%= label_tag("#{code}_yes", "Yes") %>
          </div>
        </div>

        <div class="row yes-response hide">
          <div class="col s12">

            <div class="row response-input row__0">
              <div class="input-field col s6">
                <%= text_area_tag("#{code}-response__0", "", class: "materialize-textarea") %>
                <%= label_tag("#{code}-response__0", "What was said, and who said it?") %>
              </div>
              <% if code == "impact" %>
                <%= hidden_field_tag("#{code}-type__0", "impact") %>
              <% elsif code == "plan" %>
                <%= hidden_field_tag("#{code}-type__0", "plan") %>
              <% else %>
              <div class="col s6">
                <div>
            	    <%= radio_button_tag("#{code}-type__0", "impact") %>
            	    <%= label_tag("#{code}-type__0_impact", "This is an impact") %>
                </div>
                <div>
            	    <%= radio_button_tag("#{code}-type__0", "plan") %>
          	      <%= label_tag("#{code}-type__0_plan", "This needs follow-up") %>
                </div>
              </div>
              <% end %>
              <div class="input-field col s6">
                <%= render partial: "shared/multiselect", locals: {
                  text: "Languages involved...",
                  icon: "language",
                  object: code + '-lang__0',
                  attribute: "languages",
                  display: :name,
                  collection: @minority_languages,
                  selected: Hash.new
                } %>
              </div>
            </div>

          </div>
        </div>

      </div>
    <% end %>
    <div class="yes-no-question">

      <div class="row">
        <div class="col s10">
          <i class="material-icons">question_answer</i>
          <span class="event-question">Are there any <strong>decisions or actions</strong> to be carried out?</span>
        </div>
        <div class="col s2 input-field">
          <%= radio_button_tag("decision", "no") %>
          <%= label_tag("decision_no", "No") %>
          <%= radio_button_tag("decision", "yes") %>
          <%= label_tag("decision_yes", "Yes") %>
        </div>
      </div>

      <div class="row yes-response hide">
          <div class="col s12">

            <div class="row decision-response-input row__0">
              <div class="input-field col s6">
                <%= text_area_tag("decision-response__0", "", class: "materialize-textarea") %>
                <%= label_tag("decision-response__0", "What action must be taken?") %>
              </div>
              <div class="input-field col s6">
                <%= autocomplete_field_tag "person-responsible__0", '', autocomplete_person_name_events_path %>
                <%= label_tag("person-responsible__0", "The person responsible") %>
              </div>
            </div>

          </div>
        </div>

    </div>
    <div class="row">
      <div class="input-field col s9">
        <i class="material-icons prefix">event_available</i>
        <%= f.text_area :content, class: "materialize-textarea" %>
        <%= f.label :content, "If anything else happened in the event that should be recorded, write it here." %>
      </div>
    </div>
    <div class="row">
      <div>
        <%= button_tag( :class => "btn waves-effect waves-light right") do %>
          Submit <i class="material-icons right">send</i>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
