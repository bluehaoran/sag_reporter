<% 
geo_states = current_user.geo_states.dup
if defined? form and form.object.geo_state
  geo_states << form.object.geo_state
  geo_states.uniq!
end
%>

<% if geo_states.length == 1
  if defined? form %>
    <%= form.hidden_field(:geo_state_id, value: geo_states.first.id) %>
  <% else %>
    <%= hidden_field_tag("#{object}[geo_state_id]", geo_states.first.id) %>
  <% end
else
  if defined? form %>
    <%= form.collection_select(:geo_state_id, geo_states, :id, :name) %>
    <%= form.label(:geo_state_id, "State") %>
  <% else %>
    <%= collection_select(object, :geo_state_id, geo_states, :id, :name) %>
    <%= label_tag(:geo_state_id, "State") %>
  <% end %>
<% end %>